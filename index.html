<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <meta name="theme-color" content="#121212" />
  <title>Aluno Repórter — Rádio Mobile</title>
  <meta name="description" content="Rádio web do projeto Aluno Repórter - Versão Mobile." />
  <link rel="manifest" href="./manifest.json" />
  <link rel="icon" href="./favicon.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="./styles.css" />
  <link rel="stylesheet" href="./mobile.css" />
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="preconnect" href="https://stream.radioparadise.com" crossorigin>
  <!-- Open Graph / Twitter -->
  <meta property="og:title" content="Aluno Repórter — Rádio Mobile" />
  <meta property="og:description" content="Rádio web do projeto Aluno Repórter - Versão Mobile." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/" />
  <meta property="og:image" content="https://via.placeholder.com/1200x630.png?text=Aluno+Rep%C3%B3rter" />
  <meta name="twitter:card" content="summary_large_image" />
</head>
<body class="mobile-layout">
  <div class="page">
    <!-- Mobile Header -->
    <header class="mobile-header">
      <div class="mobile-brand">
        <div id="brandLogoBtn" class="logo">AR</div>
        <div class="titles">
          <h1>Rádio Web Aluno Repórter</h1>
          <p id="stationName">Aluno Repórter</p>
        </div>
      </div>
      <div class="mobile-actions">
        <button id="mobileMenuBtn" class="icon-btn" aria-label="Menu">
          <span class="material-icons">menu</span>
        </button>
      </div>
    </header>
   
    <!-- Mobile Navigation -->
    <nav id="mobileNav" class="mobile-nav">
      <button id="navCloseBtn" class="nav-close" aria-label="Fechar menu">
        <span class="material-icons">close</span>
      </button>
      <ul class="nav-list">
        <li><a href="#hero" class="nav-link">Início</a></li>
        <li><a href="#gallery" class="nav-link">Galeria</a></li>
        <li><a href="#chat" class="nav-link">Chat</a></li>
        <li><a href="#player" class="nav-link">Player</a></li>
      </ul>
      <div class="nav-actions">
        <button id="shareBtn" class="nav-btn">
          <span class="material-icons">share</span>
          Compartilhar
        </button>
        <button id="settingsBtn" class="nav-btn">
          <span class="material-icons">settings</span>
          Configurações
        </button>
        <button id="adminBtn" class="nav-btn">
          <span class="material-icons">admin_panel_settings</span>
          Admin
        </button>
      </div>
    </nav>

    <main class="mobile-main">
      <!-- Hero Section -->
      <section id="hero" class="mobile-hero">
        <div class="hero-image-container">
          <img id="heroImage" class="hero-image studio-photo" src="https://fastly.picsum.photos/id/39/3456/2304.jpg?hmac=cc_VPxzydwTUbGEtpsDeo2NxCkeYQrhTLqw4TFo-dIg" alt="Estúdio da rádio" />
          <div class="hero-content">
            <h2>Conexão IFPA no ar!</h2>
            <p>Bem-vind@s ao nosso estúdio.</p>
          </div>
        </div>
      </section>

      <!-- Player Section -->
      <section id="player" class="mobile-player">
        <div class="player-container">
          <div class="player-info">
            <div id="trackInfo" class="track-info" hidden>Carregando...</div>
            <div class="now-playing-row">
            <span id="nowPlaying" class="now-playing">Conectando...</span>
            <span id="playingIndicator" class="playing-indicator" hidden aria-hidden="true"></span>
            </div>
          </div>
          <div class="player-controls">
            <button id="shareBtnPlayer" class="icon-btn" aria-label="Compartilhar">
              <span class="material-icons">share</span>
            </button>
            <button id="playPauseBtn" class="play-btn" aria-label="Reproduzir">
              <span class="material-icons">play_arrow</span>
            </button>
            <div class="volume-control">
              <span class="material-icons">volume_up</span>
              <input type="range" id="volumeRange" min="0" max="1" step="0.01" value="0.8" class="volume-slider" />
            </div>
          </div>
          <!-- Audio element required by app.js -->
          <audio id="radioAudio" preload="auto" crossorigin="anonymous"></audio>
          <!-- Fallback player container -->
          <div id="fallbackContainer" class="fallback hidden" style="margin-top: 1rem;">
            <iframe id="fallbackIframe" title="Rádio alternativa" loading="lazy" style="width:100%;height:180px;border:0;border-radius:8px;"></iframe>
          </div>
        </div>
      </section>


      <!-- Chat Section -->
      <section id="chat" class="mobile-chat">
        <div class="section-header">
          <h2>Mande sua mensagem!</h2>
          <button id="chatToggleBtn" class="chat-toggle">
            <span class="material-icons">chat</span>
            Abrir Chat
          </button>
        </div>
      </section>

      <!-- Requests Section -->
      <section id="requests" class="mobile-requests">
        <div class="section-header">
          <h2>Pedidos Musicais</h2>
          <button id="requestToggleBtn" class="request-toggle">
            <span class="material-icons">music_note</span>
            Fazer Pedido
          </button>
        </div>
      </section>

      <!-- Gallery Section (movida abaixo de Pedidos) -->
      <section id="gallery" class="mobile-gallery">
      <div class="section-header">
        <h2>Galeria de Fotos</h2>
        <p>Veja o que tá rolando no estúdio ao vivo!</p>
      </div>
      <div id="storiesStrip" class="stories-strip" aria-label="Destaques">
          <!-- Bolinhas dos stories serão renderizadas via JS -->
        </div>
      <div id="photoGallery" class="mobile-photo-grid">
        <!-- Fotos serão carregadas dinamicamente -->
      </div>
      <div class="section-header">
        <h1>@AlunoReporter</h1>
        <p>@AlunoReporter</p>
      </div>
      </section>

      </main>

    <!-- Mobile Bottom Navigation -->
    <nav class="bottom-nav">
      <a href="#hero" class="bottom-nav-item active">
        <span class="material-icons">home</span>
        <span>Início</span>
      </a>
      <a href="#identity" class="bottom-nav-item">
        <span class="material-icons">account_circle</span>
        <span>Usuário</span>
      </a>
      <a href="#chat" class="bottom-nav-item">
        <span class="material-icons">chat</span>
        <span>Chat</span>
      </a>
      <a href="#requests" class="bottom-nav-item">
        <span class="material-icons">music_note</span>
        <span>Pedidos</span>
      </a>
      <a href="#player" class="bottom-nav-item">
        <span class="material-icons">radio</span>
        <span>Player</span>
      </a>
    </nav>
  </div>

  <!-- Identity Modal -->
  <div id="identityModal" class="modal chat">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Identificação</h3>
        <button id="closeIdentityBtn" class="icon-btn" aria-label="Fechar">
          <span class="material-icons">close</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="identity-form">
          <div class="identity-form-fields">
            <label for="chatNameModal">Nome:</label>
            <div></div>
            <input id="chatNameModal" type="text" placeholder="Seu nome completo" maxlength="80" />
            <div></div>
            <label for="chatSchool">Escola/Instituição:</label>
            <div></div>

            <input id="chatSchool" type="text" placeholder="Ex.: De onde tu és, mano?" maxlength="80" />
          </div>
          <div>Escolha um avatar</div>
          <div id="avatarPicker" role="radiogroup" aria-label="Escolher avatar"></div>
          <p class="muted">Suas informações ficam apenas nesta sessão.</p>
        </div>
      </div>
      <div class="modal-footer">
        <button id="identitySaveBtn" class="send-btn">
          <span class="material-icons">check</span>
          <span class="btn-text"></span>
        </button>
      </div>
    </div>
  </div>

  <!-- Chat Modal -->
  <div id="chatModal" class="modal chat">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Mande sua mensagem!</h3>
        <div class="modal-actions" id="chatModalActions">
          <button id="closeChatBtn" class="icon-btn" aria-label="Fechar chat">
            <span class="material-icons">close</span>
          </button>
        </div>
      </div>
      <div class="modal-body">
        <ul id="chatList" class="chat-list" aria-live="polite" role="log" aria-relevant="additions text" aria-atomic="false"></ul>
        <div class="chat-input-container">
          <div class="message-input-section">
            <button id="avatarBtn" class="avatar-btn" aria-label="Escolher avatar">
              <img id="selectedAvatar" src="./favicon.svg" alt="Avatar" />
            </button>
            <input type="text" id="chatInput" placeholder="Mande sua mensagem!" maxlength="240" />
            <button id="chatSendBtn" class="send-btn" aria-label="Enviar mensagem">
              <span class="material-icons">send</span>
            </button>
            <div id="avatarDropdown" class="avatar-dropdown" hidden>
              <div id="avatarGrid" class="avatar-grid"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Request Modal -->
  <div id="requestModal" class="modal requests">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Pedido Musical</h3>
        <button id="closeRequestBtn" class="icon-btn" aria-label="Fechar">
          <span class="material-icons">close</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="request-input-container">
          <div class="request-form">
            <input type="text" id="requestSong" placeholder="Nome da música" maxlength="100" />
            <input type="text" id="requestArtist" placeholder="Artista" maxlength="100" />
            <button id="sendRequestBtn" class="send-btn" aria-label=""><span class="material-icons">send</span><span class="btn-text"></span></button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div id="settingsModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Configurações</h3>
        <button id="closeSettingsBtn" class="icon-btn" aria-label="Fechar">
          <span class="material-icons">close</span>
        </button>
      </div>
      <div class="modal-body">
        <div class="settings-section">
          <h4>Áudio</h4>
          <div class="setting-item">
            <label for="volumeRangeSettings">Volume</label>
            <input type="range" id="volumeRangeSettings" min="0" max="1" step="0.01" />
          </div>
        </div>
        <!-- Removido: seção de Interface / Modo escuro -->
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div id="toastContainer" class="toast-container"></div>

  <!-- Scripts -->
  <script src="https://unpkg.com/@supabase/supabase-js@2.42.7/dist/umd/supabase.min.js"></script>
  <script>
    // Opcional: injete via Netlify/Vercel em produção
    window.SUPABASE_URL = window.SUPABASE_URL || (window.__ENV && window.__ENV.SUPABASE_URL);
    window.SUPABASE_ANON_KEY = window.SUPABASE_ANON_KEY || (window.__ENV && window.__ENV.SUPABASE_ANON_KEY);
  </script>
  <script src="./api_chat.js"></script>
  <script src="./app.js"></script>
  <script src="./mobile.js"></script>
</body>
</html>